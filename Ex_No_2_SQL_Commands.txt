
-- Ex. No. 2 : HR DATABASE (SQL Commands)

SELECT first_name, last_name, salary, department_id 
FROM employees 
WHERE salary NOT BETWEEN 10000 AND 15000 
AND department_id IN (30, 100);

SELECT first_name, last_name, hire_date 
FROM employees 
WHERE YEAR(hire_date) = 1987;

SELECT first_name 
FROM employees 
WHERE first_name LIKE '%b%' 
AND first_name LIKE '%c%';

SELECT MAX(salary) 
FROM employees 
WHERE job_id = 'IT_PROG';

SELECT AVG(salary), COUNT(*) 
FROM employees 
WHERE department_id = 90;

SELECT job_id, COUNT(*) 
FROM employees 
GROUP BY job_id;

SELECT job_id, AVG(salary) 
FROM employees 
WHERE job_id <> 'IT_PROG' 
GROUP BY job_id;

SELECT department_id, AVG(salary), COUNT(*) 
FROM employees 
GROUP BY department_id 
HAVING COUNT(*) > 10;

SELECT first_name, last_name, salary 
FROM employees 
WHERE salary > (
    SELECT salary FROM employees WHERE first_name = 'Nancy'
);

SELECT first_name, last_name 
FROM employees 
WHERE department_id IN (
    SELECT department_id 
    FROM departments 
    WHERE department_name = 'IT'
);

SELECT first_name, last_name, salary 
FROM employees 
WHERE salary > (
    SELECT AVG(salary) FROM employees
);

SELECT first_name, last_name, salary 
FROM employees 
WHERE salary = (
    SELECT min_salary 
    FROM jobs 
    WHERE employees.job_id = jobs.job_id
);

SELECT * 
FROM (
    SELECT * 
    FROM employees 
    ORDER BY employee_id DESC 
    LIMIT 10
) sub 
ORDER BY employee_id ASC;

SELECT first_name, last_name 
FROM employees 
WHERE MONTH(hire_date) = 6;

SELECT YEAR(hire_date), COUNT(employee_id) 
FROM employees 
GROUP BY YEAR(hire_date) 
HAVING COUNT(employee_id) > 10;

SELECT department_name, street_address, postal_code, city, state_province 
FROM departments 
JOIN locations 
ON departments.location_id = locations.location_id;

SELECT CONCAT(first_name,' ',last_name) AS employee_name, department_name 
FROM employees 
JOIN departments 
ON employees.department_id = departments.department_id 
ORDER BY employee_name;

SELECT first_name, last_name, department_name, city 
FROM employees e 
JOIN departments d ON e.department_id = d.department_id 
JOIN locations l ON d.location_id = l.location_id 
WHERE city = 'London';

SELECT CONCAT(e1.first_name,' ',e1.last_name) AS employee_name,
       CONCAT(e2.first_name,' ',e2.last_name) AS manager_name
FROM employees e1 
JOIN employees e2 
ON e1.manager_id = e2.employee_id;

SELECT last_name, hire_date 
FROM employees 
WHERE hire_date > (
    SELECT hire_date 
    FROM employees 
    WHERE last_name = 'Jones'
);

SELECT d.department_name, COUNT(e.employee_id) 
FROM departments d 
JOIN employees e 
ON d.department_id = e.department_id 
GROUP BY d.department_name;

SELECT d.department_name, e.first_name 
FROM departments d 
JOIN employees e 
ON d.manager_id = e.employee_id;

SELECT d.department_name, e.first_name, l.city 
FROM departments d 
JOIN employees e ON d.manager_id = e.employee_id 
JOIN locations l ON d.location_id = l.location_id;

SELECT job_title, ROUND(AVG(salary),0) 
FROM jobs 
JOIN employees 
ON jobs.job_id = employees.job_id 
GROUP BY job_title;

SELECT first_name, job_title, salary - min_salary AS salary_difference 
FROM jobs j 
JOIN employees e 
ON j.job_id = e.job_id;

SELECT department_name, first_name, hire_date, salary,
DATEDIFF(NOW(), hire_date)/365 AS service_years
FROM departments d 
JOIN employees e 
ON d.manager_id = e.employee_id 
WHERE DATEDIFF(NOW(), hire_date)/365 > 15 
ORDER BY service_years DESC;

SELECT job_id, GROUP_CONCAT(employee_id), COUNT(*) 
FROM employees 
GROUP BY job_id;

SELECT phone_number, REPLACE(phone_number, '124', '999') 
FROM employees;

SELECT first_name, hire_date,
DATE_FORMAT(hire_date,'%M') AS month_name,
DATE_FORMAT(hire_date,'%W') AS weekday_name
FROM employees;

SELECT first_name, email, SUBSTR(email,1,LENGTH(email)-3) 
FROM employees;

SELECT first_name, 
LENGTH(REPLACE(first_name,'a','aa')) - LENGTH(first_name) AS a_count
FROM employees;

SELECT street_address, 
SUBSTR(street_address,1,LOCATE(' ',street_address)) 
FROM locations;

SELECT LEFT(first_name,1) AS initial, COUNT(*) 
FROM employees 
GROUP BY LEFT(first_name,1);

SELECT first_name, department_name, job_title,
CONCAT(street_address,' ',postal_code,' ',city) AS address
FROM employees e 
JOIN departments d ON e.department_id = d.department_id
JOIN jobs j ON e.job_id = j.job_id
JOIN locations l ON d.location_id = l.location_id;

SELECT e1.first_name AS employee_name
FROM employees e1 
LEFT JOIN employees e2 
ON e1.manager_id = e2.employee_id 
WHERE e2.first_name IS NULL;

SELECT COUNT(e1.first_name) AS no_of_employees,
e2.first_name AS manager_name
FROM employees e1 
JOIN employees e2 
ON e1.manager_id = e2.employee_id 
GROUP BY e2.first_name;

SELECT e2.first_name AS manager_name
FROM employees e1 
RIGHT JOIN employees e2 
ON e1.manager_id = e2.employee_id 
WHERE e1.first_name IS NULL;

SELECT department_name 
FROM departments d 
JOIN locations l 
ON d.location_id = l.location_id 
WHERE state_province IN ('California','Texas');

SELECT department_name 
FROM departments d 
JOIN locations l ON d.location_id = l.location_id
JOIN countries c ON l.country_id = c.country_id
WHERE c.country_name = 'Germany';

SELECT country_name, COUNT(department_name) 
FROM departments d 
JOIN locations l ON d.location_id = l.location_id
JOIN countries c ON l.country_id = c.country_id
GROUP BY country_name;

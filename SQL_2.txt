EX. NO. 2 â€“ HR DATABASE

-- Q1
SELECT first_name,last_name,salary,department_id FROM employees WHERE salary NOT BETWEEN 10000 AND 15000 AND department_id IN (30,100);

-- Q2
SELECT first_name,last_name,hire_date FROM employees WHERE YEAR(hire_date) LIKE '1987%';

-- Q3
SELECT first_name FROM employees WHERE first_name LIKE '%b%' AND first_name LIKE '%c%';

-- Q4
SELECT MAX(salary) FROM employees WHERE job_id='IT_PROG';

-- Q5
SELECT AVG(salary),COUNT(*) FROM employees WHERE department_id=90;

-- Q6
SELECT job_id,COUNT(*) FROM employees GROUP BY job_id;

-- Q7
SELECT job_id,AVG(salary) FROM employees WHERE job_id<>'IT_PROG' GROUP BY job_id;

-- Q8
SELECT department_id,AVG(salary),COUNT(*) FROM employees GROUP BY department_id HAVING COUNT(*)>10;

-- Q9
SELECT first_name,last_name,salary FROM employees WHERE salary>(SELECT salary FROM employees WHERE first_name='Nancy');

-- Q10
SELECT first_name,last_name FROM employees WHERE department_id IN (SELECT department_id FROM departments WHERE department_name='IT');

-- Q11
SELECT first_name,last_name,salary FROM employees WHERE salary>(SELECT AVG(salary) FROM employees);

-- Q12
SELECT first_name,last_name,salary FROM employees WHERE salary=(SELECT min_salary FROM jobs WHERE employees.job_id=jobs.job_id);

-- Q13
SELECT * FROM (SELECT * FROM employees ORDER BY employee_id DESC LIMIT 10) sub ORDER BY employee_id ASC;

-- Q14
SELECT first_name,last_name FROM employees WHERE MONTH(hire_date)=6;

-- Q15
SELECT YEAR(hire_date),COUNT(employee_id) FROM employees GROUP BY YEAR(hire_date) HAVING COUNT(employee_id)>10;

-- Q16
SELECT department_name,street_address,postal_code,city,state_province FROM departments JOIN locations ON departments.location_id=locations.location_id;

-- Q17
SELECT CONCAT(first_name,' ',last_name),department_name FROM employees JOIN departments ON employees.department_id=departments.department_id ORDER BY 1;

-- Q18
SELECT first_name,last_name,department_name,city FROM employees e JOIN departments d ON e.department_id=d.department_id JOIN locations l ON d.location_id=l.location_id WHERE city='London';

-- Q19
SELECT CONCAT(e1.first_name,' ',e1.last_name),CONCAT(e2.first_name,' ',e2.last_name) FROM employees e1 JOIN employees e2 ON e1.manager_id=e2.employee_id;

-- Q20
SELECT last_name,hire_date FROM employees WHERE hire_date>(SELECT hire_date FROM employees WHERE last_name='Jones');

-- Q21
SELECT d.department_name,COUNT(e.first_name) FROM departments d JOIN employees e ON d.department_id=e.department_id GROUP BY d.department_name ORDER BY 1;

-- Q22
SELECT d.department_name,e.first_name FROM departments d JOIN employees e ON d.manager_id=e.employee_id;

-- Q23
SELECT d.department_name,e.first_name,l.city FROM departments d JOIN employees e ON d.manager_id=e.employee_id JOIN locations l ON d.location_id=l.location_id;

-- Q24
SELECT job_title,ROUND(AVG(salary),0) FROM jobs JOIN employees ON jobs.job_id=employees.job_id GROUP BY job_title;

-- Q25
SELECT first_name,job_title,salary-min_salary FROM jobs j JOIN employees e ON j.job_id=e.job_id;

-- Q26
SELECT department_name,first_name,hire_date,salary,DATEDIFF(NOW(),hire_date)/365 AS Service FROM departments d JOIN employees e ON d.manager_id=e.employee_id WHERE DATEDIFF(NOW(),hire_date)/365>15 ORDER BY Service DESC;

-- Q27
SELECT job_id,GROUP_CONCAT(employee_id),COUNT(*) FROM employees GROUP BY job_id;

-- Q28
SELECT phone_number,REPLACE(phone_number,'124','999') FROM employees;

-- Q29
SELECT first_name,hire_date,DATE_FORMAT(hire_date,'%M'),DATE_FORMAT(hire_date,'%W') FROM employees;

-- Q30
SELECT first_name,email,SUBSTR(email,1,LENGTH(email)-3) FROM employees;

-- Q31
SELECT first_name,LENGTH(REPLACE(first_name,'a','aa'))-LENGTH(first_name) FROM employees;

-- Q32
SELECT street_address,SUBSTR(street_address,1,LOCATE(' ',street_address)) FROM locations;

-- Q33
SELECT LEFT(first_name,1),COUNT(*) FROM employees GROUP BY LEFT(first_name,1);

-- Q34
SELECT first_name,department_name,job_title,CONCAT(street_address,' ',postal_code,' ',city) FROM employees e JOIN departments d ON e.department_id=d.department_id JOIN jobs j ON e.job_id=j.job_id JOIN locations l ON d.location_id=l.location_id;

-- Q35
SELECT e2.first_name,e1.first_name FROM employees e1 LEFT JOIN employees e2 ON e1.manager_id=e2.employee_id WHERE e2.first_name IS NULL;

-- Q36
SELECT COUNT(e1.first_name),e2.first_name FROM employees e1 JOIN employees e2 ON e1.manager_id=e2.employee_id GROUP BY e2.first_name;

-- Q37
SELECT e2.first_name FROM employees e1 RIGHT JOIN employees e2 ON e1.manager_id=e2.employee_id WHERE e1.first_name IS NULL;

-- Q38
SELECT department_name FROM departments d JOIN locations l ON d.location_id=l.location_id WHERE state_province IN ('California','Texas');

-- Q39
SELECT department_name FROM departments d JOIN locations l ON d.location_id=l.location_id JOIN countries c ON l.country_id=c.country_id WHERE c.country_name LIKE 'Germany';

-- Q40
SELECT country_name,COUNT(department_name) FROM departments d JOIN locations l ON d.location_id=l.location_id JOIN countries c ON l.country_id=c.country_id GROUP BY country_name;

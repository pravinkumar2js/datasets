EX. NO. 3 â€“ PUBLICATIONS DATABASE

-- Q1
SELECT au_fname,au_lname,state FROM authors WHERE state NOT LIKE 'CA';

-- Q2
SELECT state,COUNT(*) FROM authors GROUP BY state;

-- Q3
SELECT title,price FROM titles WHERE price=(SELECT MAX(price) FROM titles);

-- Q4
SELECT title,pub_name FROM titles t JOIN publishers p ON t.pub_id=p.pub_id;

-- Q5
SELECT pub_name,title FROM publishers p LEFT JOIN titles t ON p.pub_id=t.pub_id ORDER BY pub_name;

-- Q6
SELECT stor_name FROM stores WHERE stor_id IN (SELECT stor_id FROM sales WHERE title_id='PS7777');

-- Q7
SELECT CONCAT(fname,' ',lname),pub_id FROM employee WHERE pub_id=0877;

-- Q8
SELECT a1.au_fname,a1.au_lname,a1.city,a1.zip,a1.address FROM authors a1,authors a2 WHERE a1.au_id<>a2.au_id AND a1.city=a2.city AND a1.zip=a2.zip AND a1.address=a2.address ORDER BY a1.address;

-- Q9
SELECT title,p.pub_name,state FROM titles t JOIN publishers p ON t.pub_id=p.pub_id AND p.state NOT LIKE 'CA';

-- Q10
SELECT stor_name,COUNT(ord_num) FROM stores JOIN sales ON stores.stor_id=sales.stor_id GROUP BY stor_name;

-- Q11
SELECT pub_name,COUNT(*) FROM publishers p JOIN titles t ON p.pub_id=t.pub_id GROUP BY pub_name ORDER BY COUNT(*) DESC LIMIT 1;

-- Q12
SELECT pub_name,COUNT(fname) FROM publishers p JOIN employee e ON p.pub_id=e.pub_id GROUP BY pub_name;

-- Q13
SELECT job_desc,min_lvl,max_lvl FROM jobs WHERE min_lvl>100 AND max_lvl<250;

-- Q14
SELECT CONCAT(au_fname,' ',au_lname),advance FROM titles t JOIN titleauthor ta ON t.title_id=ta.title_id JOIN authors a ON a.au_id=ta.au_id WHERE advance>10000;

-- Q15
SELECT title,stor_name FROM titles JOIN sales ON titles.title_id=sales.title_id JOIN stores ON sales.stor_id=stores.stor_id;

-- Q16
SELECT title,stor_id FROM titles LEFT JOIN sales ON titles.title_id=sales.title_id WHERE stor_id IS NULL;

-- Q17
SELECT title,COUNT(au_id) FROM titles JOIN titleauthor ON titles.title_id=titleauthor.title_id GROUP BY title HAVING COUNT(au_id)=2;

-- Q18
SELECT au_lname,title FROM authors JOIN titleauthor ON authors.au_id=titleauthor.au_id JOIN titles ON titleauthor.title_id=titles.title_id;

-- Q19
SELECT au_fname,royaltyper,city FROM authors JOIN titleauthor ON authors.au_id=titleauthor.au_id WHERE royaltyper=100 AND city LIKE 'Oakland';

-- Q20
SELECT stor_name FROM stores JOIN sales ON stores.stor_id=sales.stor_id JOIN titles ON sales.title_id=titles.title_id WHERE title LIKE 'Is Anger the Enemy%';

-- Q21
SELECT stor_name,title FROM stores JOIN sales ON stores.stor_id=sales.stor_id JOIN titles ON sales.title_id=titles.title_id WHERE stor_name LIKE 'News & Brews%';

-- Q22
SELECT pub_name FROM publishers p LEFT JOIN titles t ON p.pub_id=t.pub_id WHERE t.pub_id IS NULL;

-- Q23
SELECT title,type FROM titles WHERE type LIKE '%cook';

-- Q24
SELECT au_fname FROM authors WHERE LENGTH(au_fname)=5 AND (au_fname LIKE '%a' OR au_fname LIKE '%o');

-- Q25
SELECT UPPER(LEFT(title,25)),ytd_sales,ROUND(ytd_sales/12,0) FROM titles;


